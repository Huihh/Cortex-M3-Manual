# 3. 编程模型 (Programmers Model)

该章节将介绍处理器编程模型。包含以下部分：

- 关于编程模型
- 操作模式和执行模式
- 指令集
- 系统地址映射
- 写缓冲区 (Write buffer)
- 位带 (Bit-banding)
- 处理器核心寄存器
- 异常



## 3.1. 关于编程模型 (About the programmers model)

**ARMv7-M Architecture Reference Manual** 中对编程模型进行完整的解释。本章概述实现定义选项的 Cortex-M3 处理器的程序模型。也包含 ARMv7-M Thumb 指令的使用和指令执行的周期。此外：

- 第四章节概述编程模型的系统控制特点。
- 第五章节概述编程模型的 MPU 特点。
- 第六章节概述编程模型的 NVIC 特点。
- 第七章节概述编程模型的 Debug 特点。
- 第八章节概述编程模型的 DWT 特点。
- 第九章节概述编程模型的 ITM 特点。
- 第十章节概述编程模型的 ETM 特点。
- 第十一章节概述编程模型的 TPIU 特点。



## 3.2. 操作模式和执行模式 (Modes of operation and execution)

该节简单描述 Cortex-M3 处理器的操作模式和执行模式。详见 **ARMv7-M Architecture Reference Manual** 。



### 3.2.1. 操作模式 (Operation modes)

处理器支持两种操作模式，分别为 **Thread** 模式 和 **Handler** 模式：

- 处理器在复位后，或异常返回后进入 **Thread** 模式。特权和用户代码都可以运行在 **Thread** 模式。
- 处理器在发生异常时进入 **Handler** 模式。在 **Handler** 模式中只能运行特权代码。



### 3.2.2.  操作状态 (Operating states)

处理器可以在以下两种状态中操作：

- **Thumb 状态**：用于正常执行 16-bit 和 32-bit 半字对齐的 **Thumb** 指令。
- **Debug 状态**：用于调试时停止处理器。



### 3.2.3. 特权访问和用户访问 (Privileged access and user access)

代码可以作为特权和非特权执行。非特权执行有一些限制或排除对某些资源的访问。特权执行可以访问所有资源。**Handler** 模式总是特权执行。**Thread** 模式可以是特权或非特权执行。